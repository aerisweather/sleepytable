(function($,undefined){if(window.SleepyTable!==undefined){return}var SleepyTable;var MODE_HATEOAS="hateoas",MODE_PAGE="page",STATE_INIT="init",STATE_LOADING="loading",STATE_HAS_DATA="hasData";function debug(value){if(typeof console!=="undefined"&&typeof console.log!=="undefined"){console.log(value)}else{alert(value)}}function benchmark(stringLead,startDate){debug(stringLead+" ("+(new Date().getTime()-startDate.getTime())+"ms)")}function indexOf(value,array){var i=0,l=array.length,v;if(typeof value==="undefined"){return -1}if(value.constructor===String){for(;i<l;i=i+1){if(value.localeCompare(array[i])===0){return i}}}else{for(;i<l;i=i+1){v=array[i];if(v.constructor===String){if(v.localeCompare(value)===0){return i}}else{if(v===value){return i}}}}return -1}function getKeys(obj){var keys=[];for(var key in obj){keys.push(key)}return keys}function getDynamicPath(path,index){var splitSrc=path.split("[]");return splitSrc[0]+"["+index+"]"+splitSrc[1]}function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor}SleepyTable=clazz(Object,{init:function(settings){this.debug=debug;this.config=$.extend(true,{},$.fn.SleepyTable.defaults,settings);this.state=STATE_INIT;this.hasInitialized=false;if(this.config.debug){debug("Initializing");$.data(this,"startInitTimer",new Date())}if(this.hasInitialized===true){if(this.config.debug){debug("Already Initialized, aborting.")}return}this.config.requestHandlers=[];this.config.$headers=this.config.$element.find("thead tr th");this.config.$body=this.config.$element.find("tbody");this.config.silentTimer=null;this.config.displayedRowCount=0;this.config.$element.data("SleepyTable",this);if(this.config.debug){debug("Theme: "+this.config.theme)}if(this.config.theme!==""){this.config.$element.addClass("sleepytable-"+this.config.theme)}this.pages={};this.pagesRaw={};this.addHeaders();if(this.config.hateoas!=null){this.mode=MODE_HATEOAS}else{this.mode=MODE_PAGE}if(this.config.debug){debug("Loading Plugins...")}this.plugins=[];var pluginName,pluginBase,plugin;for(var i in this.config.plugins){pluginName=this.config.plugins[i];if(typeof($.fn.SleepyTable.plugins[pluginName])==="object"){pluginBase=$.fn.SleepyTable.plugins[pluginName];plugin=$.extend(true,{},pluginBase,this.config.pluginOptions[pluginName]);plugin.name=pluginName;this.plugins.push(plugin);if(typeof(plugin.init)=="function"){plugin.init(this)}else{if(this.config.debug){debug("Plugin: "+pluginName+" has no onInit method")}}}else{if(this.config.debug){debug("Plugin: "+pluginName+" wasn't loaded")}}}if(typeof(this.config.onInit)==="function"){this.config.onInit.apply(this)}this.hasInitialized=true;if(this.config.debug){benchmark("Overall initialization time",$.data(this,"startInitTimer"))}this.setPage(1)},clearPagesActual:function(){if(this.config.debug){debug("Clearing pages...")}this.pages={};this.pagesRaw={};this.hook("clearedPages");this.setPage(1)},addHeaders:function(header){if(this.config.debug){debug("addHeaders");debug(header)}var config=this.config,attrib,i;if(header!=undefined){config.$element.find("thead").remove();var $tableHeader=$("<thead></thead>");var $tableRow=$("<tr></tr>");for(attrib in header){if(attrib!="content"){$tableRow.attr(attrib,header[attrib])}}$tableRow.addClass(config.cssHeaderRow);var headerSettings;for(i in header.content){headerSettings=header.content[i];var $th=$("<th></th>");for(attrib in headerSettings){if(attrib=="content"){$th.html(headerSettings[attrib])}else{$th.attr(attrib,headerSettings[attrib])}}$tableRow.append($th)}var $headerRow=$tableHeader.append($tableRow);config.$element.prepend($headerRow);config.$headers=$tableRow.find("th");this.hook("headersChanged",config.$headers)}config.$element.find("thead").addClass(config.cssHeader)},renderPage:function(pageNumber){if(this.config.debug){debug("renderPage: "+pageNumber)}var config=this.config,page=this.pages[pageNumber],pageRaw=this.pagesRaw[pageNumber];if(page){if(page.headers&&page.headers.content.length&&config.$headers.length==0){if(config.debug){debug("Add page headers")}this.addHeaders(page.headers)}if(config.heightFixed){var preHeight=config.$element.height();config.$element.css("height","auto")}if(config.$body.length==0){config.$element.append("<tbody></tbody>");config.$body=config.$element.find("tbody");if(config.debug){debug("Missed finding tbody, added one.");debug(config.$body[0])}}else{config.$element.find("tbody").empty()}config.displayedRowCount=0;for(var i in page.rows){if(config.debug){debug("Rending row...")}config.displayedRowCount++;this.addRow(i,page.rows[i],pageRaw)}if(config.heightFixed){var currentHeight=config.$element.height();if(currentHeight>preHeight){preHeight=currentHeight}config.$element.css("height",preHeight)}this.hook("pageDisplay",pageNumber,page,pageRaw)}else{config.$element.find("tbody").empty().append(config.emptyRowHtml)}},addRow:function(rowNumber,rowData,pageRaw){var config=this.config,$body=config.$body,attrib,tdAttrib,$tr=$("<tr></tr>"),$td,i,value;if(typeof(this.config.onRenderRow)=="function"){if(this.config.rawRowDataSelection!=null&&pageRaw){$tr=$(this.config.onRenderRow(pageRaw[this.config.rawRowDataSelection][rowNumber]))}else{$tr=$(this.config.onRenderRow(rowData))}}else{for(attrib in rowData){if(attrib=="content"){for(i in rowData[attrib]){$td=$("<td></td>");for(tdAttrib in rowData.content[i]){value=rowData.content[i][tdAttrib];if(value!=undefined){if(tdAttrib=="content"){$td.html(value.toString())}else{$td.attr(tdAttrib,value.toString())}}}$tr.append($td)}}else{value=rowData[attrib];if(value!=undefined){$tr.attr(attrib,value.toString())}}}}if(config.debug){debug("Appending row to: ");debug($body[0])}$body.append($tr)},print:function(){},hook:function(eventName){if(this.config.debug){debug("Hook: "+eventName)}var pluginName="",plugin,pluginArgs,newArgs,returnValue;newArgs=Array.prototype.slice.call(arguments);newArgs.shift();newArgs.unshift(this);for(var i in this.plugins){plugin=this.plugins[i];if(typeof(plugin)==="object"&&typeof(plugin[eventName])=="function"){returnValue=$.extend(true,{},returnValue,plugin[eventName].apply(plugin,newArgs))}else{}}var funcName="on"+eventName.charAt(0).toUpperCase()+eventName.substr(1);if(typeof(this.config[funcName])=="function"){newArgs.shift();returnValue=$.extend(true,{},returnValue,this.config[funcName].apply(this,newArgs))}return returnValue},fetchPage:function(pageNumber){if(this.config.debug){debug("Fetching page: "+pageNumber)}var config=this.config,url,i,pageOffset,data,value,transport=config.ajaxTransport,handler;if(pageNumber==this.config.currentPageNumber){if(this.config.$body.length!=0){var $body=this.config.$body,height=$body.outerHeight();$body.empty().append(config.loadingRowHtml);$body.find("tr").css("height",height)}this.hook("pageLoading");this.state=STATE_LOADING}data={};data=this.hook("getFetchParams",data);if(config.page0Based){pageOffset=config.offsetInitial+((pageNumber)*config.limit)}else{pageOffset=config.offsetInitial+((pageNumber-1)*config.limit)}var url="";if(this.config.debug){debug("Pages raw: ")}if(this.config.debug){debug(this.pagesRaw)}if(this.mode==MODE_HATEOAS){if(this.pagesRaw[pageNumber-1]!=undefined&&config.hateoas.pageNext){url=eval("this.pagesRaw[pageNumber-1]."+config.hateoas.pageNext)}else{if(this.pagesRaw[pageNumber+1]!=undefined&&config.hateoas.pagePrevious){url=eval("this.pagesRaw[pageNumber+1]."+config.hateoas.pagePrevious)}}}if(url==""){url=config.url.replace(/\{(page|offset|limit)\}/gi,function(m){return{"{page}":pageNumber,"{offset}":pageOffset,"{limit}":config.limit}[m]})}if(typeof(transport)!=="function"){if(this.config.debug){debug("transport setting isn't a valid funciton")}}handler=transport.call(null,{url:url,dataType:config.dataType,data:data,type:config.httpMethod,traditional:config.traditionalSerialization,pageNumber:pageNumber,context:this,success:function(data){if(typeof(this.config.ajaxProcessing)==="function"){var pageData=this.config.ajaxProcessing.call(null,data)}else{var pageData={rows:[]},row=0,moreRows=false,colValue="",i,rows,splitSrc;do{moreRows=false;if(this.config.$headers.length==0&&this.config.rawRowDataSelection!=null){rows=eval("data."+this.config.rawRowDataSelection);if(rows&&rows.length){var headerObj={content:[]},headers=getKeys(rows[0]),i;for(var i in headers){headerObj.content[i]={};headerObj.content[i].content=headers[i].replace(/([A-Z])/g," $1").replace(/^./,function(str){return str.toUpperCase()});headerObj.content[i]["data-var-name"]=headers[i]}this.addHeaders(headerObj)}}if(this.config.$headers.length){this.config.$headers.each(function(index){try{if($(this).data("src")!=undefined){colValue=eval("data."+getDynamicPath($(this).data("src"),row));if(typeof(pageData.rows[row])=="undefined"){pageData.rows[row]={content:[]}}pageData.rows[row].content.push({content:colValue});if(moreRows==false&&eval("data."+getDynamicPath($(this).data("src"),row+1))!=undefined){moreRows=true}}}catch(e){}});row++}else{if(this.config.rawRowDataSelection!=null){rows=eval("data."+this.config.rawRowDataSelection);if(rows&&rows.length){for(i in rows){if(typeof(pageData.rows[i])=="undefined"){pageData.rows[i]={content:[]}}for(var key in rows[i]){colValue=rows[i][key];pageData.rows[i].content.push({content:colValue})}}}}}}while(moreRows);if(pageData.rows.length>0){this.pages[pageNumber]=pageData;this.pagesRaw[pageNumber]=data}else{this.pages[pageNumber]=false;this.pagesRaw[pageNumber]=data}}this.hook("pageLoaded",pageNumber,pageData,data);if(this.config.debug){debug("Got page: "+pageNumber)}if(pageNumber==this.config.currentPageNumber){this.renderPage(pageNumber)}},error:function(jqXHR,textStatus,errorThrown){if(this.config.debug){debug("Page "+pageNumber+" doesn't exist.")}this.pages[pageNumber]=false;this.pagesRaw[pageNumber]=data}});config.requestHandlers.push(handler)},setPage:function(pageNumber){if(this.pages[pageNumber]==undefined){this.config.currentPageNumber=pageNumber;this.fetchPage(pageNumber)}else{if(this.pages[pageNumber]==false){}else{if(this.config.debug){debug("Rendering existing page")}this.config.currentPageNumber=pageNumber;this.renderPage(pageNumber)}}if(this.config.preLoadNextPage){if(this.pages[this.config.currentPageNumber+1]==undefined){this.fetchPage(this.config.currentPageNumber+1)}if(this.config.currentPageNumber>1&&this.pages[this.config.currentPageNumber-1]==undefined){this.fetchPage(this.config.currentPageNumber-1)}}},clearPages:function(){if(this.config.silentTimer!=null){this.config.silentTimer.clearTimeout()}var sleepyTableInstance=this;this.config.silentTimer=setTimeout(function(){sleepyTableInstance.clearPagesActual();sleepyTableInstance.config.silentTimer=null},this.config.silentDelay)},first:function(){this.setPage(1)},previous:function(){if(this.config.currentPageNumber>1){this.setPage(this.config.currentPageNumber-1)}},next:function(){this.setPage(this.config.currentPageNumber+1)},last:function(){if(this.config.debug){debug("Not implemented yet.")}}});$.fn.SleepyTable=function(){var args=Array.prototype.slice.call(arguments,0),opts,sleepyTable,value,allowedMethods=["container","fetchData","setPage","clearPages","first","previous","next","last","sortAdvance","sortSetAppend","sortClear","filterSet"];this.each(function(){if(args.length===0||typeof(args[0])==="object"){opts=args.length===0?{}:$.extend({},args[0]);opts.$element=$(this);sleepyTable=new SleepyTable();sleepyTable.init(opts)}else{if(typeof(args[0])==="string"){value=undefined;sleepyTable=$(this).data("SleepyTable");var pluginMethod=false,plugin,pluginName,pluginCursor,j;if(indexOf(args[0],allowedMethods)==-1){if(sleepyTable.plugins instanceof Array){for(pluginCursor in sleepyTable.plugins){plugin=sleepyTable.plugins[pluginCursor];pluginName=sleepyTable.config.plugins[pluginCursor];if(plugin.publicMethods instanceof Array){for(j in plugin.publicMethods){if("plugin."+pluginName+"."+plugin.publicMethods[j]==args[0]){pluginMethod=true;break}}}if(pluginMethod==true){break}}}if(pluginMethod===false){if(pluginName){var methodParts=args[0].split(".");var pluginFound=false;for(pluginCursor in sleepyTable.plugins){if(sleepyTable.plugins[pluginCursor].name==methodParts[1]){pluginFound=true;break}}if(!pluginFound){if(sleepyTable.config.debug){debug("Plugin: "+methodParts[1]+" isn't loaded")}}else{if(sleepyTable.config.debug){debug(methodParts[1]+" Plugin Method: "+methodParts[2]+" isn't a valid method")}}}else{throw"Unknown method: "+args[0]}}}if(sleepyTable===undefined){return}if(args[0]==="container"){value=sleepyTable.container}else{try{if(pluginMethod){var newArgs=args.slice(1);newArgs.unshift(sleepyTable);value=plugin[plugin.publicMethods[j]].apply(plugin,newArgs)}else{value=sleepyTable[args[0]].apply(sleepyTable,args.slice(1))}}catch(err){}}if(value!==undefined){return false}}else{throw"Invalid arguments to sleepyTable plugin: "+args}}});return(value===undefined)?this:value};$.fn.SleepyTable.defaults={debug:false,theme:"default",widthFixed:false,heightFixed:true,url:"http://www.example.com/api/?page={page}&limit={limit}",ajaxProcessing:null,ajaxTransport:$.ajax,dataType:"jsonp",httpMethod:"GET",traditionalSerialization:false,currentPageNumber:1,page0Based:false,offsetInitial:0,limit:10,hateoas:null,preLoadNextPage:true,silentDelay:500,loadingRowHtml:'<tr class="sleepytable-loading"><td colspan="9999"><img src="assets/loading.gif"/> Loading...</td></tr>',emptyRowHtml:'<tr class="sleepytable-empty"><td colspan="9999">[No entries]</td></tr>',rawRowDataSelection:null,plugins:[],pluginOptions:{},onInit:null,onHeaderChanges:null,onGetFetchParams:null,onPageLoaded:null,onPageLoading:null,onPageDisplay:null,onClearedPages:null,cssTable:"sleepytable",cssHeader:"sleepytable-header",cssIcon:"sleepytable-icon",cssInfoBlock:"sleepytable-infoOnly",cssProcessing:"sleepytable-processing"};$.fn.SleepyTable.plugins={};window.SleepyTable={}})(jQuery);$.fn.SleepyTable=$.fn.SleepyTable||{};$.fn.SleepyTable.plugins=$.fn.SleepyTable.plugins||{};(function($,undefined){PLACEHOLDER="!-placeholder-!",$.fn.SleepyTable.plugins.filter={debug:false,columnOptions:{},sleepTime:700,filterTimer:null,cssFilterRow:"sleepytable-filter-row",cssFilterDisabled:"sleepytable-filter-disabled",$filterRow:null,$filterHeaders:[],publicMethods:["set"],init:function(tableObj){var config=tableObj.config,$thead,$filterRow,$th,thisPlugin=this;if(config.$headers.length!==0){$thead=config.$element.find("thead").first();$thead.find("tr."+this.cssFilterRow).remove();$filterRow=$("<tr></tr>").addClass(this.cssFilterRow);var filterPlugin=this;config.$headers.each(function(i,elem){$th=$("<th></th>");if(filterPlugin.columnOptions[i]==undefined){filterPlugin.columnOptions[i]={}}if(filterPlugin.columnOptions[i].enabled!==false){if(filterPlugin.columnOptions[i]&&filterPlugin.columnOptions[i].type&&filterPlugin.columnOptions[i].type.toLowerCase()=="select"){$th.html('<select placeholder="Choose a filter"></select>');var $select;if(filterPlugin.columnOptions[i].source){$select=$th.find("select");$select.html('<option value="'+PLACEHOLDER+'">Loading Options...</option>');config.ajaxTransport.call(null,{url:filterPlugin.columnOptions[i].source,dataType:filterPlugin.columnOptions[i].dataType,data:filterPlugin.columnOptions[i].data,type:filterPlugin.columnOptions[i].httpMethod||"GET",traditional:config.traditionalSerialization,context:{columnId:i,$table:config.$element,$element:$select,path:filterPlugin.columnOptions[i].options,placeholder:filterPlugin.columnOptions[i].placeholder,value:filterPlugin.columnOptions[i].value,getDynamicPath:filterPlugin.getDynamicPath,debug:filterPlugin.debug},success:function(data){var pathParts=this.path.split("[]"),elements=eval("data."+pathParts[0]),i,display,options="";if(this.debug){tableObj.debug("Filter value: "+this.columnId+" to "+this.value)}for(i in elements){display=eval("data."+this.getDynamicPath(this.path,i));if(display!==undefined){options+='<option value="'+i+'">'+display.toString()+"</option>"}}this.$element.find("option").html(this.placeholder||"Choose filter...");this.$element.append(options);if(this.value!=undefined){if(this.debug){tableObj.debug("Filter AJAX, calling filterSet "+this.columnId+" to "+this.value)}this.$table.SleepyTable("plugin.filter.set",this.columnId,this.value)}},error:function(jqXHR,textStatus,errorThrown){this.$element.attr("disabled",true).empty()}})}else{if(filterPlugin.columnOptions[i].options){$select=$th.find("select");$select.html('<option value="'+PLACEHOLDER+'">'+(filterPlugin.columnOptions[i].placeholder||"Select Filter...")+"</option>");for(var j in filterPlugin.columnOptions[i].options){$select.append('<option value="'+j+'">'+filterPlugin.columnOptions[i].options[j]+"</option>")}}}}else{var placeholderText="";if(filterPlugin.columnOptions[i]&&filterPlugin.columnOptions[i].placeholder){placeholderText=filterPlugin.columnOptions[i].placeholder}var valueText="";if(filterPlugin.columnOptions[i]&&filterPlugin.columnOptions[i].value!==undefined){valueText=filterPlugin.columnOptions[i].value}else{filterPlugin.columnOptions[i].value=""}$th.html('<input type="search" placeholder="'+placeholderText+'" value="'+valueText+'" />')}}else{$th.html('<input type="search" class="'+this.cssFilterDisabled+'" disabled="disabled"></input>')}$filterRow.append($th);$th.find(" > select").off("change.SleepyTable.plugin.filter").on("change.SleepyTable.plugin.filter",function(event){config.$element.SleepyTable("plugin.filter.set",i,$(this).val())});$th.find(" > input").off("keyup.SleepyTable.plugin.filter, change.SleepyTable.plugin.filter").on("keyup.SleepyTable.plugin.filter, change.SleepyTable.plugin.filter",function(event){if(this.filterTimer!=null){clearTimeout(this.filterTimer);this.filterTimer=null}if(filterPlugin.debug){tableObj.debug("Setting value to: "+$(this).val())}var value=$(this).val();this.filterTimer=setTimeout(function(){if(filterPlugin.debug){tableObj.debug("Timout running with: "+value)}config.$element.SleepyTable("plugin.filter.set",i,value);this.filterTimer=null;config.$element.SleepyTable("plugin.history.filterChange",thisPlugin.getFetchParams(tableObj,{},true))},filterPlugin.sleepTime)})});$thead.append($filterRow);this.$filterHeaders=$filterRow.find("th");this.$filterHeaders.each(function(i){if(filterPlugin.columnOptions[i].value!==undefined){config.$element.SleepyTable("plugin.filter.set",i,filterPlugin.columnOptions[i].value,false)}})}},headersChanged:function(tableObj,headers){this.init(tableObj)},getFetchParams:function(tableObj,data,columnIdValueMode){var config=tableObj.config,filterPlugin;if(data==undefined){data={}}if(columnIdValueMode==undefined){columnIdValueMode=false}if(this.debug){tableObj.debug("Filter: ");tableObj.debug("filterOptions: ");tableObj.debug(this.columnOptions)}filterPlugin=this;if(this.$filterHeaders.length){this.$filterHeaders.each(function(columnId){var $header=$(config.$headers[columnId]);value=filterPlugin.columnOptions[columnId].value;if(value!=PLACEHOLDER&&value!=""&&value!=undefined){if(filterPlugin.columnOptions[columnId]&&filterPlugin.columnOptions[columnId].varName!==undefined){varName=filterPlugin.columnOptions[columnId].varName}else{if($header.data("varFilter")!==undefined){varName=$header.data("varFilter")}else{if($header.data("src")!==undefined){var dataParts=$header.data("src").split("[]");varName=dataParts.pop();if(varName.charAt(0)=="."){varName=varName.substr(1)}}else{}}}if(columnIdValueMode){data[columnId]=value}else{data[varName]=value}}})}return data},set:function(tableObj,columnId,value,updateData){if(this.debug){tableObj.debug("Filter Plugin: Setting "+columnId+" to "+value)}var config=tableObj.config;if(this.columnOptions[columnId]==undefined){this.columnOptions[columnId]={}}if(this.columnOptions[columnId].value==undefined){this.columnOptions[columnId].value=""}if(typeof(this.columnOptions[columnId].translation)=="function"){this.columnOptions[columnId].value=this.columnOptions[columnId].translation(value)}else{this.columnOptions[columnId].value=value}$(this.$filterHeaders[columnId]).children().val(value);if(updateData!==false){config.$element.SleepyTable("clearPages")}},getDynamicPath:function(path,index){var splitSrc=path.split("[]");return splitSrc[0]+"["+index+"]"+splitSrc[1]}}})(jQuery);$.fn.SleepyTable=$.fn.SleepyTable||{};$.fn.SleepyTable.plugins=$.fn.SleepyTable.plugins||{};(function($,undefined){MODE_HATEOAS="hateoas",MODE_PAGE="page",$.fn.SleepyTable.plugins.pager={debug:false,buttons:{pageFirst:{enabled:false,method:"first",selector:".first"},pagePrevious:{enabled:false,method:"previous",selector:".prev"},pageNext:{enabled:false,method:"next",selector:".next"},pageLast:{enabled:false,method:"last",selector:".last"}},mode:null,$element:null,$displayElement:null,$limitElement:null,displayTemplate:"Page {pageNumber} ({startRow} to {endRow})",loadingTemplate:"Loading Data...",preventEventBubbling:true,cssGoto:".goto-page",cssDisplay:".page-display",cssSize:".page-size",publicMethods:["setLimit"],init:function(tableObj){if(this.$element==undefined||this.$element.length==0){if(this.debug){tableObj.debug("No paging element found")}}this.$element.each(function(){$(this).off("change.SleepyTable.plugin.pager").on("change.SleepyTable.plugin.pager",function(){tableObj.config.$element.SleepyTable("clearPages")})});if(tableObj.config.hateoas!=null){this.mode=MODE_HATEOAS}else{this.mode=MODE_PAGE}if(this.$displayElement==null){this.$displayElement=this.$element.find(this.cssDisplay)}if(this.$limitElement==null){this.$limitElement=this.$element.find(this.cssSize);var thisPlugin=this;this.$limitElement.off("change.SleepyTable.plugin.pager").on("change.SleepyTable.plugin.pager",function(e){e.preventDefault();tableObj.config.currentPageNumber=1;thisPlugin.getFetchParams(tableObj,{});tableObj.config.$element.SleepyTable("clearPages");tableObj.config.$element.SleepyTable("plugin.history.pagerChange",{limit:tableObj.config.limit,page:1})});this.$limitElement.parent().off("click.SleepyTable.plugin.pager").on("click.SleepyTable.plugin.pager",function(e){e.preventDefault()})}this.pageLoading(tableObj)},getFetchParams:function(tableObj,data){if(this.$limitElement){tableObj.config.limit=parseInt(this.$limitElement.val())}return data},pageLoading:function(tableObj){var button;for(button in this.buttons){this.disableButton(tableObj,button)}this.$displayElement.html(this.loadingTemplate)},pageDisplay:function(tableObj,pageNumber,page,pageRaw){if(this.debug){tableObj.debug("Plugin Pager: pageDisplay "+this.mode)}var config=tableObj.config,i,value,pagerOutput;if(page!==undefined){if(this.mode==MODE_HATEOAS){for(i in config.hateoas){try{if(this.debug){tableObj.debug("Setting Button: "+i+", path: "+config.hateoas[i])}value=eval("pageRaw."+config.hateoas[i]);if(this.debug){tableObj.debug("- value: "+value)}if(value!==undefined){if(i=="pageNext"&&tableObj.pages[config.currentPageNumber+1]==false){this.disableButton(tableObj,i)}if(i=="pagePrev"&&tableObj.pages[config.currentPageNumber-1]==false){this.disableButton(tableObj,i)}this.enableButton(tableObj,i,value)}else{this.disableButton(tableObj,i)}}catch(e){}}}else{if(this.mode==MODE_PAGE){for(var button in this.buttons){this.disableButton(tableObj,button);switch(button){case"pageFirst":if(tableObj.pages[1]&&config.currentPageNumber!=1){this.enableButton(tableObj,button)}break;case"pagePrevious":if(tableObj.pages[config.currentPageNumber-1]){this.enableButton(tableObj,button)}break;case"pageNext":if(tableObj.pages[config.currentPageNumber+1]){this.enableButton(tableObj,button)}break;case"pageLast":break}}}}}if(this.debug){tableObj.debug(this.buttons)}if(this.debug){tableObj.debug("Plugin Pager: Setting Paging display text")}pagerOutput=this.displayTemplate.replace(/\{(pageNumber|totalPages|startRow|endRow|totalRows)\}/gi,function(m){var startRow=(config.page0Based)?(config.currentPageNumber*config.limit)+1:((config.currentPageNumber-1)*config.limit)+1;return{"{pageNumber}":config.currentPageNumber,"{totalPages}":config.totalPages,"{startRow}":startRow,"{endRow}":startRow+config.displayedRowCount-1,"{totalRows}":config.totalRows}[m]});this.$displayElement.html(pagerOutput)},pageLoaded:function(tableObj,pageNumber,page,pageRaw){this.pageDisplay(tableObj,pageNumber,page,pageRaw)},enableButton:function(tableObj,buttonId,value){if(this.debug){tableObj.debug("Plugin Pager: Enabling Button: "+buttonId)}var button=this.buttons[buttonId];button.enabled=true;button.value=value;var pagerPlugin=this;this.$element.find(button.selector).off("click.SleepyTable.plugin.pager").on("click.SleepyTable.plugin.pager",function(e){if(pagerPlugin.preventEventBubbling==true){e.preventDefault()}tableObj.config.$element.SleepyTable(button.method);tableObj.config.$element.SleepyTable("plugin.history.pagerChange",{limit:tableObj.config.limit,page:parseInt(tableObj.config.currentPageNumber)})}).parent().removeClass("disabled")},disableButton:function(tableObj,buttonId){if(this.debug){tableObj.debug("Plugin Pager: Disabling Button: "+buttonId)}var button=this.buttons[buttonId];button.enabled=false;button.value=null;this.$element.find(button.selector).off("click.SleepyTable.plugin.pager").parent().addClass("disabled")},setLimit:function(tableObj,limit){this.$limitElement.val(limit)}}})(jQuery);$.fn.SleepyTable=$.fn.SleepyTable||{};$.fn.SleepyTable.plugins=$.fn.SleepyTable.plugins||{};(function($,undefined){KEY={ALT:"altKey",SHIFT:"shiftKey",CTRL:"ctrlKey"};$.fn.SleepyTable.plugins.sort={debug:false,columnOptions:{},currentOrder:[],additionalKey:KEY.SHIFT,dataVariable:"sort",dataKeyValue:":",dataDelimeter:",",cssSorterRow:"sleepytable-sort-row",cssSortActive:"sleepytable-sort-active",cssSortAsc:"sleepytable-sort-asc",cssSortDesc:"sleepytable-sort-desc",cssSortDisabled:"sleepytable-sort-disabled",cssSortIconBoth:"icon-sort-both",cssSortIconAsc:"icon-sort-asc",cssSortIconDesc:"icon-sort-desc",$sortRow:null,$sortHeaders:[],publicMethods:["advance","clear","init","setAppend","setSort"],init:function(tableObj){var sorterPlugin,config=tableObj.config,i,orderObj,$icon,varName,thisPlugin=this;this.$sortRow=config.$element.find("thead tr").first().addClass(this.cssSorterRow),this.$sortHeaders=this.$sortRow.find("th");if(this.$sortRow){for(var i in this.currentOrder){orderObj=this.currentOrder[i];if(this.debug){tableObj.debug("Setting initial sort: "+orderObj.column+" "+orderObj.value)}if(this.columnOptions[orderObj.column]==undefined){this.columnOptions[orderObj.column]={}}this.columnOptions[orderObj.column].direction=orderObj.value}sorterPlugin=this;this.$sortHeaders.each(function(i,elem){var $elem=$(elem);if(sorterPlugin.columnOptions[i]==undefined){sorterPlugin.columnOptions[i]={}}$icon=$elem.find("i");if(!$icon.length&&(sorterPlugin.cssSortAsc.length||sorterPlugin.cssSortDesc.length)){$icon=$elem.append('<i class="'+sorterPlugin.cssSortIconBoth+'"/>');$icon=$elem.find("i")}if(sorterPlugin.columnOptions[i]&&sorterPlugin.columnOptions[i].varName!==undefined){varName=sorterPlugin.columnOptions[i].varName}else{if($elem.data("varName")!==undefined){varName=$elem.data("varName")}else{if($elem.data("src")!==undefined){var dataParts=$elem.data("src").split("[]");varName=dataParts.pop();if(varName.charAt(0)=="."){varName=varName.substr(1)}}else{}}}sorterPlugin.columnOptions[i].varName=varName;if(sorterPlugin.columnOptions[i]&&sorterPlugin.columnOptions[i].enabled==false){$elem.addClass(sorterPlugin.cssSortDisabled).removeClass(sorterPlugin.cssSortDesc+" "+sorterPlugin.cssSortAsc+" "+sorterPlugin.cssSortActive);$icon.removeClass(sorterPlugin.cssSortIconBoth+" "+sorterPlugin.cssSortIconAsc+" "+sorterPlugin.cssSortIconDesc)}else{if(sorterPlugin.columnOptions[i].direction==1||sorterPlugin.columnOptions[i].direction==-1){config.$element.SleepyTable("plugin.sort.setAppend",i,sorterPlugin.columnOptions[i].direction,false)}$elem.off("click.SleepyTable.plugin.sort").on("click.SleepyTable.plugin.sort",function(event){if(eval("event."+sorterPlugin.additionalKey)){config.$element.SleepyTable("plugin.sort.advance",i,event)}else{var direction=sorterPlugin.columnOptions[i].direction;config.$element.SleepyTable("plugin.sort.clear",false);config.$element.SleepyTable("plugin.sort.setAppend",i,direction,false);config.$element.SleepyTable("plugin.sort.advance",i,event)}config.$element.SleepyTable("plugin.history.sortChange",thisPlugin.currentOrder)}).off("onselectstart.SleepyTable.plugin.sort").on("onselectstart.SleepyTable.plugin.sort",function(e){e.preventDefault();return false})}})}},headersChanged:function(tableObj,headers){this.init(tableObj)},getFetchParams:function(tableObj,data,dataKeyValue,dataDelimeter){if(dataKeyValue==undefined){dataKeyValue=this.dataKeyValue}if(dataDelimeter==undefined){dataDelimeter=this.dataDelimeter}if(this.debug){tableObj.debug("Building Sort Variables:");tableObj.debug(data)}if(data==undefined){data={}}data[this.dataVariable]="";if(this.debug){tableObj.debug("sortOrderCurrent: ")}if(this.debug){tableObj.debug(this.currentOrder)}var columnId,direction,varName,$header;for(i in this.currentOrder){if(this.debug){tableObj.debug("Looping through current order")}columnId=this.currentOrder[i].column,direction=this.currentOrder[i].value,varName=this.currentOrder[i].varName,$header=$(this.$sortHeaders[columnId]);if($header.hasClass(this.cssSortActive)){if(this.debug){tableObj.debug(" - Column "+columnId+": "+varName)}data[this.dataVariable]+=varName+dataKeyValue+direction+dataDelimeter}}return data},advance:function(tableObj,column,event){if(this.debug){debug("sortAdvance")}var config=tableObj.config,direction;if(this.columnOptions[column]==undefined){this.columnOptions[column]={}}if(this.columnOptions[column].direction==undefined){this.columnOptions[column].direction=0}switch(this.columnOptions[column].direction){case 0:direction=1;break;case 1:direction=-1;break;case -1:direction=0;break}config.$element.SleepyTable("plugin.sort.setAppend",column,direction)},setAppend:function(tableObj,column,value,updateData){if(this.debug){tableObj.debug("sort.setAppend "+column+" "+value)}var config=tableObj.config,$elem=$(this.$sortHeaders[column]),$icon=$elem.find("i");if(this.columnOptions[column]==undefined){this.columnOptions[column]={}}if(this.columnOptions[column].direction==undefined){this.columnOptions[column].direction=0}this.columnOptions[column].direction=value;if(this.columnOptions[column].enabled!==false){switch(this.columnOptions[column].direction){case -1:case"desc":$elem.addClass(this.cssSortActive+" "+this.cssSortDesc).removeClass(this.cssSortDisabled+" "+this.cssSortAsc);$icon.addClass(this.cssSortIconDesc).removeClass(this.cssSortIconBoth+" "+this.cssSortIconAsc);break;case 1:case"asc":$elem.addClass(this.cssSortActive+" "+this.cssSortAsc).removeClass(this.cssSortDisabled+" "+this.cssSortDesc);$icon.addClass(this.cssSortIconAsc).removeClass(this.cssSortIconBoth+" "+this.cssSortIconDesc);break;default:$elem.removeClass(this.cssSortDisabled+" "+this.cssSortActive+" "+this.cssSortDesc+" "+this.cssSortAsc);$icon.addClass(this.cssSortIconBoth).removeClass(this.cssSortIconDesc+" "+this.cssSortIconAsc);break}}for(var k in this.currentOrder){if(this.currentOrder[k].column==column){this.currentOrder.splice(k,1);break}}if(value!==0){this.currentOrder.push({column:column,value:this.columnOptions[column].direction,varName:this.columnOptions[column].varName})}if(updateData!==false){config.$element.SleepyTable("clearPages")}},clear:function(tableObj,updateData){if(this.debug){tableObj.debug("sort.clear Called")}this.currentOrder=[];var plugin=this;this.$sortHeaders.each(function(i){plugin.setAppend(tableObj,i,0,false)});if(updateData!==false){config.$element.SleepyTable("clearPages")}},setSort:function(tableObj,currentOrder){this.currentOrder=currentOrder;this.init(tableObj);tableObj.clearPagesActual()}}})(jQuery);